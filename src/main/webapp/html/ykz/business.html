<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>商机列表</title>
    <link rel="stylesheet" href="/layui/css/layui.css" media="all">
    <style>
        .box1{
            width: 16%;
            position: absolute;
        }
        .box2{
            width: 83%;
            position: absolute;
            left:17%;
            top:70px
        }
    </style>
    <script type="text/javascript">
        var a1=function(){
            window.location.href="/html/ykz/businessadd.html"
        }
        var a2=function(){
            window.location.href=""
        }
    </script>
</head>
<body>
<div  class="box1"><!--style="float:left;width: 199px"-->
    <div class="site-text">
        <div><font size="5" color="#ff1493">全部商机</font></div><br><br>
        <form class="layui-form layui-form-pane" action="">
            <div class="layui-form-item layui-form-text" style="width:200px;height: 250px;">
                <label class="layui-form-label"><font size="3" color="black">分类</font></label>
                <div class="layui-input-block" style="border:1px solid ;color: #e2e2e2;height:400px;">
                    <ul>
                        <li><a href="#" onclick=""><img src="/html/ykz/img/u214.png">我负责的商机</a></li>
                        <li><a href="#" onclick=""><img src="/html/ykz/img/u214.png">我参与的商机</a></li>
                        <li><a href="#" onclick=""><img src="/html/ykz/img/u214.png">我关注的商机</a></li>
                        <li><a href="#" onclick=""><img src="/html/ykz/img/u214.png">7天未跟单</a></li>
                        <li><a href="#" onclick=""><img src="/html/ykz/img/u214.png">30天未跟单</a></li>
                        <li><a href="#" onclick=""><img src="/html/ykz/img/u214.png">90天未跟单</a></li>
                    </ul>
                    <div style="width: 200px"><font color="silver">——————————————</font></div>
                    <ul>
                        <li><a href="#" onclick="thisweek('本周')"><img src="/html/ykz/img/u214.png">本周新增</a></li>
                        <li><a href="#" onclick="lastweek('上周')"><img src="/html/ykz/img/u214.png">上周新增</a></li>
                        <li><a href="#" onclick="thismonth('本月')"><img src="/html/ykz/img/u214.png">本月新增</a></li>
                        <li><a href="#" onclick="lastmonth('上月')"><img src="/html/ykz/img/u214.png">上月新增</a></li>
                        <li><a href="#" onclick="thiseomonth('本季')"><img src="/html/ykz/img/u214.png">本季度新增</a></li>
                        <li><a href="#" onclick="lasteomonth('上季')"><img src="/html/ykz/img/u214.png">上季度新增</a></li>

                    </ul>
                    <div style="width: 200px"><font color="silver">——————————————</font></div>
                    <ul>
                        <li><a href="#" onclick="make('成交')"><img src="/html/ykz/img/u214.png">已成交的商机</a></li>
                        <li><a href="#" onclick="place('丢单')"><img src="/html/ykz/img/u214.png">已丢单的商机</a></li>
                        <li><a href="#" onclick="shelve('搁置')"><img src="/html/ykz/img/u214.png">已搁置的商机</a></li>
                    </ul>
                </div>
            </div>
        </form>
    </div>
</div>
<div class="box2"><!--style="float: left;margin-left: 200px;margin-top: 30px"-->
    <form class="layui-form"  action="" method="post">
            <center>
                <table width="1050">
                    <tr>
                        <td>商机全称</td>
                        <td>
                            <div class="layui-form-item" align="center">
                                <div class="layui-input-block">
                                    <input type="text" name="businessname"  style="width: 290px;" required lay-verify="" placeholder="请输入"
                                           autocomplete="off" class="layui-input">
                                </div>
                            </div>
                        </td>
                        <td>商机阶段</td>
                        <td align="right">
                            <div class="layui-form-item">
                                <div class="layui-input-block">
                                    <input type="text" name="todaystate"  style="width: 290px;" required lay-verify="" placeholder="请输入"
                                           autocomplete="off" class="layui-input">
                                </div>
                            </div>
                        </td>
                    </tr>


                    <tr>
                        <td>商机负责人</td>
                        <td>
                            <input type="hidden" name="userId" id="userId">
                            <div class="layui-form-item" align="center">
                                <div class="layui-input-block">
                                    <input type="text" id="username"  style="width: 290px;" required lay-verify="" placeholder="请输入"
                                           autocomplete="off" class="layui-input">
                                </div>
                            </div>
                        </td>
                        <td>所属部门</td>
                        <td align="right">
                            <div class="layui-form-item">
                                <div class="layui-input-block">
                                    <input type="text" name="post"  style="width: 290px;" required lay-verify="" placeholder="请输入"
                                           autocomplete="off" class="layui-input">
                                </div>
                            </div>
                        </td>
                    </tr>

                    <tr>
                        <td>预计成交金额</td>
                        <td>
                            <div class="layui-form-item" align="center">
                                <div class="layui-input-block">
                                    <input type="text" name="makemoney"  style="width: 290px;" required lay-verify="" placeholder="请输入"
                                           autocomplete="off" class="layui-input">
                                </div>
                            </div>
                        </td>
                        <td>预计结单日期</td>
                        <td align="right">
                            <div class="layui-inline">
                                <div class="layui-input-inline">
                                    <input type="text" name="overdate"  style="width: 290px;" class="layui-input" id="date1" placeholder="yyyy-MM-dd">
                                </div>
                            </div>
                        </td>
                    </tr>

                </table><br><br>
                <div class="layui-form-item" style="width: 80%">
                    <div class="layui-input-block">
                        <button style="width: 120px" class="layui-btn layui-btn-normal" lay-submit lay-filter="formDemo">查找商机</button>
                        <button type="reset" style="width: 120px" class="layui-btn layui-btn-primary" >重置</button>
                    </div>
                </div>
            </center>
    </form>
    <input align="right" data-method="offset" data-type="r" class="layui-btn layui-btn-normal" type="button" onclick="a1()" value="新增 " style="font-size: 20px;font-weight: bold;width:100px;height:40px;">
    <input align="right" data-method="offset" data-type="r" class="layui-btn layui-btn-normal" type="button" onclick="a2()" value="刷新 " style="font-size: 20px;font-weight: bold;width:100px;height:40px;">
    <table id="demo" lay-filter="test"></table>
</div>
<!--<div style="margin-left: 600px;margin-top: 650px;">
    <center>

    </center>
</div>-->


<script src="/layui/layui.js"></script>
<script>
    layui.use(['table', 'form', 'layer', 'upload', 'laydate'], function () {
        var table = layui.table;
        var form = layui.form;
        var layer = layui.layer;
        var upload = layui.upload;
        var $=layui.jquery;
        var laydate = layui.laydate;

        //第一个实例
        table.render({
            elem: '#demo'
            , height: 400
            , width: 1050
            , toolbar: '#barDemo1'
            , url: '/business/businessQueryall.do' //数据接口
            , page: true //开启分页
            , limits: [1, 2, 5, 6, 8, 10, 15, 20]
            , limit: 10
            , cols: [[
                {type: 'numbers', title: "序号", width: 77}/*,templet:'<div><a href="" style="color: #0000FF">{{d.}}</a></div>'*/
                , {field: 'businessname', title: '商机名称', width: 232 ,templet:'<div><a href="/business/queryall.do?businessid={{d.businessid}}" style="color: #0000FF">{{d.businessname}}</a></div>'}
                , {field: 'todaystate', title: '商机阶段', width: 130 , sort: true}
                , {field: 'makemoney', title: '预计成交金额', width: 151, sort: true}
                , {field: 'userId', title: '商机负责人', width: 150 , sort: true}
                , {field: 'documentarytime', title: '最后跟单时间', width: 160 ,templet:'<div><a href="#" style="color: #0000FF">{{d.documentarytime}}</a></div>', sort: true }
                , {field: 'forum', title: '讨论版', width: 140,templet:'<div><a href="#" style="color: #0000FF">{{d.forum}}</a></div>', sort: true }
            ]]
        });

        window.thisweek=function (data) {
            table.reload('demo',{
                url :'/business/businessQueryall.do',
                where: {
                    status:data
                },
                page: {
                    curr: 1 //重新从第 1 页开始
                }
            });
        }

        window.lastweek=function (data) {
            table.reload('demo',{
                url :'/business/businessQueryall.do',
                where: {
                    status:data
                },
                page: {
                    curr: 1 //重新从第 1 页开始
                }
            });
        }

        window.thismonth=function (data) {
            table.reload('demo',{
                url :'/business/businessQueryall.do',
                where: {
                    status:data
                },
                page: {
                    curr: 1 //重新从第 1 页开始
                }
            });
        }

        window.lastmonth=function (data) {
            table.reload('demo',{
                url :'/business/businessQueryall.do',
                where: {
                    status:data
                },
                page: {
                    curr: 1 //重新从第 1 页开始
                }
            });
        }

        window.thiseomonth=function (data) {
            table.reload('demo',{
                url :'/business/businessQueryall.do',
                where: {
                    status:data
                },
                page: {
                    curr: 1 //重新从第 1 页开始
                }
            });
        }

        window.lasteomonth=function (data) {
            table.reload('demo',{
                url :'/business/businessQueryall.do',
                where: {
                    status:data
                },
                page: {
                    curr: 1 //重新从第 1 页开始
                }
            });
        }

        window.make=function (data) {
            table.reload('demo',{
                url :'/business/businessQueryall.do',
                where: {
                    status:data
                },
                page: {
                    curr: 1 //重新从第 1 页开始
                }
            });
        }

        window.place=function (data) {
            table.reload('demo',{
                url :'/business/businessQueryall.do',
                where: {
                    status:data
                },
                page: {
                    curr: 1 //重新从第 1 页开始
                }
            });
        }

        window.shelve=function (data) {
            table.reload('demo',{
                url :'/business/businessQueryall.do',
                where: {
                    status:data
                },
                page: {
                    curr: 1 //重新从第 1 页开始
                }
            });
        }

        //监听提交   模糊查询
        form.on('submit(formDemo)', function (data) {
            table.reload('demo', {
                url: '/business/businessQueryall.do',
                where: { //设定异步数据接口的额外参数，任意设
                    businessname: data.field.businessname
                    , todaystate: data.field.todaystate
                    , userId: data.field.userId
                    , post: data.field.post
                    , makemoney: data.field.makemoney
                    , overdate: data.field.overdate
                }
                , page: {
                    curr: 1 //重新从第 1 页开始
                }
            }); //只重载数据
            return false;
        });


        $(function () {
            $("#username").blur(function(){
                var username=$("#username").val();
                $.ajax( {
                    url : "/user/queryname.do?username="+username,
                    type : "GET",
                    dataType: "json",
                    success: function(data){
                        if(data.userid==null){
                            $("#userId").val("0");
                        }else{
                            $("#userId").val(data.userid);
                        }
                    }
                })
            });
        });




        //时间
        laydate.render({
            elem: '#date1'
        });

    });
</script>
</body>
</html>