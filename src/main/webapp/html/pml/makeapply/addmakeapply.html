<!DOCTYPE html>
<!--suppress ALL-->
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>开票申请单</title>
    <link rel="stylesheet" href="../../../layui/css/layui.css">
    <script src="../../../js/jquery-3.4.1.js"></script>
    <script src="../../../layui/layui.js"></script>
</head>
<script type="text/javascript">
    goback=function () {
        window.location.href="../html/pml/contract/queryContract.html";
    }
    refresh=function () {
        window.location.href="";
    }
</script>
<body>
<form class="layui-form" action="/makeapply/addMakeapply.do" method="post">
    <center>
        <table width="80%">
            <tr>
                <td width="20%"><font size="5">开票申请单</font></td>
                <td width="20%"></td>
                <td width="20%"></td>
                <td width="20%" align="right">
                    <button type="button" class="layui-btn layui-btn-primary" onclick="goback()"><i class="layui-icon layui-icon-return">返回</i></button>
                    <button type="button" class="layui-btn layui-btn-primary" onclick="refresh()"><i class="layui-icon layui-icon-refresh">刷新</i></button>
                </td>
            </tr>
            <tr>
                <td height="20px"></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr bgcolor="#fafad2">
                <td height="50px"><h2>新增售后服务</h2></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td height="5px"></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td><font color="red">*</font>主题</td>
                <td>
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <input type="text" name="theme" id="theme" required="" lay-verify="theme" placeholder="请输入主题" autocomplete="off" class="layui-input" >
                        </div>
                    </div>
                </td>
                <td align="center">结束时间</td>
                <td align="right">
                    <div class="layui-form">
                        <div class="layui-form-item">
                            <div class="layui-inline">
                                <div class="layui-input-inline">
                                    <input type="date" class="layui-input" id="overtime" name="overtime" lay-verify="begintime" placeholder="yyyy-MM-dd" lay-key="1">
                                </div>
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td></td>
                <td>
                    <div class="layui-form-item" style="margin-left: 40px;">
                        步  骤:<input type="text" style="border: 0px"  value="服务登记" name="step"><br/>
                        责任人:<input type="text" style="border: 0px"  id="username" name="username"> readonly ><br/>
                        <input type="hidden" style="border: 0px"  id="userid" name="userid">
                        参与人:<input type="text" style="border: 0px"  value="" name="participant">
                    </div>
                </td>
                <td align="center">详细地址</td>
                <td align="right">
                    <div class="layui-form-item" align="center">
                        <div class="layui-input-block">
                            <input type="text" name="detailedaddress"  id="detailedaddress" required lay-verify="" placeholder="请输入"
                                   autocomplete="off" class="layui-input">
                        </div>
                    </div>
                </td>
            </tr>
            <tr bgcolor="#fafad2">
                <td height="50px"><h2>申请信息</h2></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td height="5px"></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td><font color="red">*</font>申请人姓名</td>
                <td>
                    <div class="layui-form-item" align="center">
                        <div class="layui-input-block">
                            <input type="text" name="username" id="username" required lay-verify="" placeholder="请输入"
                                   autocomplete="off" class="layui-input" onblur="selectUser(this.value)">
                        </div>
                    </div>
                </td>
                <td align="center">所属部门</td>
                <td align="right">
                    <div class="layui-form-item" align="center">
                        <div class="layui-input-block">
                            <input type="text" name="userid" id="userid" required lay-verify="" placeholder="请输入"
                                   autocomplete="off" class="layui-input">
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>申请日期</td>
                <td>
                    <div class="layui-form">
                        <div class="layui-form-item">
                            <div class="layui-inline">
                                <div class="layui-input-inline">
                                    <input type="date" class="layui-input" id="begintime" name="appletime" lay-verify="appletime" placeholder="yyyy-MM-dd" lay-key="1">
                                </div>
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>主要技术条款</td>
                <td colspan="3">
                    <div align="center" class="layui-form-item">
                        <div class="layui-input-block">
                            <textarea name="technicalterms" id="technicalterms" class="layui-input" required="" placeholder="请输入" autocomplete="off" lay-verify="">                            </textarea>
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>对方单位名称</td>
                <td>
                    <div class="layui-form-item" align="center">
                        <div class="layui-input-block">
                            <input type="text" name="telephone" id="telephone" required lay-verify="" placeholder="请输入"
                                   autocomplete="off" class="layui-input">
                        </div>
                    </div>
                </td>
                <td align="center">关联合同</td>
                <td align="right">
                    <div class="layui-form-item" align="center">
                        <div class="layui-input-block">
                            <input type="text" name="contractid" th:value="${contractList.contractid}" id="contractid" required lay-verify="" placeholder="请输入"
                                   autocomplete="off" class="layui-input">
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>开票种类</td>
                <td>
                    <div class="layui-form-item" align="center">
                        <div class="layui-input-block">
                            <input type="text" name="makekind" id="makekind"  required lay-verify="" placeholder="请输入"
                                   autocomplete="off" class="layui-input">
                        </div>
                    </div>
                </td>
                <td align="center">纳税人识别号</td>
                <td align="right">
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <input type="text" name="username" id="username"  required="" lay-verify="required" placeholder="请输入" autocomplete="off" class="layui-input" >
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td><font color="red">*</font>开户行及账号</td>
                <td>
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <input type="text" name="username" id="username"  required="" lay-verify="required" placeholder="请输入" autocomplete="off" class="layui-input" >
                        </div>
                    </div>
                </td>
                <td align="center">地址和电话</td>
                <td align="right">
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <input type="text" name="username" id="username"  required="" lay-verify="required" placeholder="请输入" autocomplete="off" class="layui-input" >
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td><font color="red">*</font>开票金额</td>
                <td>
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <input type="text" name="makemoney" id="makemoney" th:value="${contractList.makecount}"  required="" lay-verify="required" placeholder="请输入" autocomplete="off" class="layui-input" >
                        </div>
                    </div>
                </td>
                <td align="center">开票日期</td>
                <td align="right">
                    <div class="layui-form">
                        <div class="layui-form-item">
                            <div class="layui-inline">
                                <div class="layui-input-inline">
                                    <input type="date" class="layui-input" id="makedate" name="makedate" placeholder="yyyy-MM-dd" lay-key="1" readonly>
                                </div>
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>发票号码</td>
                <td>
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <input type="text" name="invoicenumber" id="invoicenumber"  required="" lay-verify="required" placeholder="请输入" autocomplete="off" class="layui-input" >
                        </div>
                    </div>
                </td>
                <td align="center">附件</td>
                <td align="right">
                <div class="layui-upload">
                    <button type="button" class="layui-btn" id="card"><i class="layui-icon layui-icon-upload-drag"></i>上传图片</i></button>
                    <div class="layui-upload-list">
                        <label class="layui-form-label">预览附件</label>
                        <img class="layui-upload-img" id="idcard" style="width: 100px;height: 100px;">
                    </div>
                </div>
                <input type="hidden" name="attachment" id="attachment" lay-verify="photo">
                </td>
            </tr>
            <tr>
                <td height="20px"></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr bgcolor="#fafad2">
                <td height="50px"><h2>处理流程日志</h2></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
        </table><br><br>
        <div class="site-text">
            <div style="width:1250px;">
                <div style="float: left">
                        <div class="layui-input-block" style="border:1px solid ;color: #e2e2e2;height:480px;width:400px;">
                            <div>
                                <font size="3" color="black">【处理流程】</font><br/>
                                ----------------------------------------------------------------------
                            </div>
                            <a href="#"><font style="color: blue">&nbsp;&nbsp;&nbsp;&nbsp;哈哈哈哈哈</font></a>
                        </div>
                </div>
                <div style="float: left">
                        <div class="layui-form-item layui-form-text" style="margin-left: 160px;">
                            <div class="layui-input-block" style="border:1px solid ;color: #e2e2e2;height:220px;width: 400px;">
                                <div>
                                    <font size="3" color="black">【父事务】</font><br/>
                                    ----------------------------------------------------------------------
                                </div>
                                <a href="#"><font style="color: blue">&nbsp;&nbsp;&nbsp;&nbsp;哈哈哈哈哈</font></a>
                            </div>
                        </div>
                        <div class="layui-form-item layui-form-text" style="margin-left: 160px; margin-top: 20px;">
                            <div class="layui-input-block" style="border:1px solid ;color: #e2e2e2;height:220px;width: 400px;">
                                <div>
                                    <font size="3" color="black">【子事务】</font><br/>
                                    ----------------------------------------------------------------------
                                </div>
                                <a href="#"><font style="color: blue">&nbsp;&nbsp;&nbsp;&nbsp;哈哈哈哈哈</font></a>
                            </div>
                        </div>
                </div>
            </div>
        </div>
        <div class="layui-form-item" style="width: 80%;margin-left: 20px;">
            <div class="layui-input-block">
                <p>
                    <button class="layui-btn layui-btn-radius layui-btn-primary" lay-submit lay-filter="formDemo">保存</button>
                    <button type="button" class="layui-btn layui-btn-radius layui-btn-primary">提交财务处理</button>
                    <button type="button" class="layui-btn layui-btn-radius layui-btn-primary" onclick="goback()">取消</button>
                </p>
            </div>
        </div>
    </center>

</form>
<script>
    layui.use(['form', 'layer', 'upload', 'laydate'], function () {
        var form = layui.form;
        var layer = layui.layer;
        var upload = layui.upload;
        var $=layui.jquery;

        //普通图片上传
        var uploadInst = upload.render({
            elem: '#card'
            ,url: '/aftersale/upload.do' //改成您自己的上传接口
            ,before: function(obj){
                //预读本地文件示例，不支持ie8
                obj.preview(function(index, file, result){
                    $('#idcard').attr('src', result); //图片链接（base64）
                });
            }
            ,done: function(res){
                //如果上传失败
                if(res.code == 0){
                    $("#attachment").val(res.data)
                    layer.msg('上传成功', {icon: 6});
                }else{
                    layer.msg('上传失败', {icon: 5});
                }
            }
        });

        function selectCustomer(d){
            $.ajax({
                type:'get',
                url: '/customer/queryAllByName.do?customername='+d,
                datatype: 'json',
                success:function(customer){
                    $("#industry").val(customer.industry);
                    $("#city").val(customer.city);
                    $("#address").val(customer.address);
                    $("#department").val(customer.department);
                }
            });
        }


    });
</script>
</body>
</html>