<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>新增售后服务</title>
    <link rel="stylesheet" href="../../../layui/css/layui.css">
    <script src="../../../js/jquery-3.4.1.js"></script>
    <script src="../../../layui/layui.js"></script>
</head>
<body>
<form class="layui-form" action="" method="post">
    <center>
        <table width="80%">
            <tr>
                <td width="20%"><font size="5">新增售后服务</font></td>
                <td width="20%"></td>
                <td width="20%"></td>
                <td width="20%" align="right">
                    <button type="button" class="layui-btn layui-btn-primary" ><i class="layui-icon layui-icon-return">返回</i></button>
                    <button type="button" class="layui-btn layui-btn-primary" ><i class="layui-icon layui-icon-refresh">刷新</i></button>
                </td>
            </tr>
            <tr>
                <td height="20px"></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr bgcolor="#fafad2">
                <td height="50px"><h2>新增售后服务</h2></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td height="5px"></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>主题</td>
                <td>
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <input type="text" name="title" required="" lay-verify="required" placeholder="请输入主题" autocomplete="off" class="layui-input" >
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td></td>
                <td>
                    <div class="layui-form-item" style="margin-left: 40px;">
                        步  骤: 服务登记 &nbsp;&nbsp;
                        责任人：王娜 &nbsp;&nbsp;&nbsp;
                        参与人： &nbsp;&nbsp;
                    </div>
                </td>
            </tr>
            <tr bgcolor="#fafad2">
                <td height="50px"><h2>售后服务信息</h2></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td height="5px"></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>客户名称</td>
                <td>
                    <div class="layui-form-item">
                        <div class="layui-input-block" >
                            <select name="customername" id="customername"   lay-filter="customername" lay-verify="required" onchange="customerChange()">
                                <option value="">请选择</option>
                            </select>
                        </div>
                    </div>
                </td>
                <td align="center">合同编号</td>
                <td align="right">
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <select id="contractId" name="contractId" lay-verify="required" lay-filter="contractId">
                                <option value="">请选择</option>
                            </select>
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>合同主要信息</td>
                <td colspan="3">
                    <div align="center" class="layui-form-item">
                        <div class="layui-input-block">
                            <textarea name="info" id="info" class="layui-input" required="" placeholder="请输入" autocomplete="off" lay-verify="">                            </textarea>
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>对方联系人</td>
                <td>
                    <div class="layui-form-item" align="center">
                        <div class="layui-input-block">
                            <input type="text" name="contactperson" id="contactperson" required lay-verify="" placeholder="请输入"
                                   autocomplete="off" class="layui-input">
                        </div>
                    </div>
                </td>
                <td align="center">固定电话</td>
                <td align="right">
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <input type="text" name="officephone" id="officephone"  required lay-verify="" placeholder="请输入"
                                   autocomplete="off" class="layui-input">
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>移动电话</td>
                <td>
                    <div class="layui-form-item" align="center">
                        <div class="layui-input-block">
                            <input type="text" name="telephone" id="telephone" required lay-verify="" placeholder="请输入"
                                   autocomplete="off" class="layui-input">
                        </div>
                    </div>
                </td>
                <td align="center">邮件/QQ</td>
                <td align="right">
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <input type="text" name="email" id="email" required lay-verify="" placeholder="请输入"
                                   autocomplete="off" class="layui-input">
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>服务类型</td>
                <td>
                    <div class="layui-form-item">
                        <div class="layui-input-block" >
                            <select name="typeservices" lay-verify="required">
                                <option value="">请选择</option>
                                <option value="故障申报">故障申报</option>
                                <option value="业务咨询">业务咨询</option>
                                <option value="实施或培训">实施或培训</option>
                                <option value="主动关怀">主动关怀</option>
                                <option value="其他">其他</option>
                            </select>
                        </div>
                    </div>
                </td>
                <td align="center">服务方式</td>
                <td align="right">
                    <div class="layui-form-item">
                        <div class="layui-input-block" >
                            <select id="servicemode" name="contractId" lay-verify="required">
                                <option value="">请选择</option>
                                <option value="故障申报">故障申报</option>
                                <option value="业务咨询">业务咨询</option>
                                <option value="实施或培训">实施或培训</option>
                                <option value="主动关怀">主动关怀</option>
                                <option value="其他">其他</option>
                            </select>
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>开始时间</td>
                <td>
                    <div class="layui-form">
                    <div class="layui-form-item">
                        <div class="layui-inline">
                            <div class="layui-input-inline">
                                <input type="text" class="layui-input" id="begintime" placeholder="yyyy-MM-dd" lay-key="1">
                            </div>
                        </div>
                    </div>
                </div>
                </td>
                <td align="center">结束时间</td>
                <td align="right">
                    <div class="layui-form">
                        <div class="layui-form-item">
                            <div class="layui-inline">
                                <div class="layui-input-inline">
                                    <input type="text" class="layui-input" id="overtime" placeholder="yyyy-MM-dd" lay-key="1">
                                </div>
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>服务内容</td>
                <td colspan="3">
                    <div align="center" class="layui-form-item">
                        <div class="layui-input-block">
                            <textarea name="servicescontent" class="layui-input" required="" placeholder="请输入" autocomplete="off" lay-verify="">                            </textarea>
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>客户反馈</td>
                <td colspan="3">
                    <div align="center" class="layui-form-item">
                        <div class="layui-input-block">
                            <textarea name="customerfeedback" class="layui-input" required="" placeholder="请输入" autocomplete="off" lay-verify="">                            </textarea>
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>服务人员</td>
                <td>
                    <div class="layui-form-item" align="center">
                        <div class="layui-input-block">
                            <input type="text" name="servicespeople"  required lay-verify="" placeholder="请输入"
                                   autocomplete="off" class="layui-input">
                        </div>
                    </div>
                </td>
                <td align="center">服务评分</td>
                <td align="right">
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <input type="radio" value="5" name="servicesscore" title="5分">
                            <input type="radio" value="4" name="servicesscore" title="4分">
                            <input type="radio" value="3" name="servicesscore" title="3分">
                            <input type="radio" value="2" name="servicesscore" title="2分">
                            <input type="radio" value="1" name="servicesscore" title="1分">
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>附件</td>
                <td>
                    <div class="layui-form-item" align="center">
                        <div class="layui-input-block">
                            <button type="button" class="layui-btn" id="uploadTest"><i class="layui-icon"></i>上传文件</button>
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td height="20px"></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr bgcolor="#fafad2">
                <td height="50px"><h2>处理流程日志</h2></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
        </table><br><br>
        <div class="site-text">
            <div style="width:1250px;">
                <div style="float: left">
                        <div class="layui-input-block" style="border:1px solid ;color: #e2e2e2;height:480px;width:400px;">
                            <div>
                                <font size="3" color="black">【处理流程】</font><br/>
                                ----------------------------------------------------------------------
                            </div>
                            <a href="#"><font style="color: blue">&nbsp;&nbsp;&nbsp;&nbsp;哈哈哈哈哈</font></a>
                        </div>
                </div>
                <div style="float: left">
                        <div class="layui-form-item layui-form-text" style="margin-left: 160px;">
                            <div class="layui-input-block" style="border:1px solid ;color: #e2e2e2;height:220px;width: 400px;">
                                <div>
                                    <font size="3" color="black">【父事务】</font><br/>
                                    ----------------------------------------------------------------------
                                </div>
                                <a href="#"><font style="color: blue">&nbsp;&nbsp;&nbsp;&nbsp;哈哈哈哈哈</font></a>
                            </div>
                        </div>
                        <div class="layui-form-item layui-form-text" style="margin-left: 160px; margin-top: 20px;">
                            <div class="layui-input-block" style="border:1px solid ;color: #e2e2e2;height:220px;width: 400px;">
                                <div>
                                    <font size="3" color="black">【子事务】</font><br/>
                                    ----------------------------------------------------------------------
                                </div>
                                <a href="#"><font style="color: blue">&nbsp;&nbsp;&nbsp;&nbsp;哈哈哈哈哈</font></a>
                            </div>
                        </div>
                </div>
            </div>
        </div>
        <div class="layui-form-item" style="width: 80%;margin-left: 20px;">
            <div class="layui-input-block">
                <p>
                    <button type="button" class="layui-btn layui-btn-radius layui-btn-normal">保存</button>
                    <button type="button" class="layui-btn layui-btn-radius layui-btn-primary">转服务人员处理</button>
                    <button type="button" class="layui-btn layui-btn-radius layui-btn-primary">本次服务完成</button>
                    <button type="button" class="layui-btn layui-btn-radius layui-btn-primary">取消</button>
                </p>
            </div>
        </div>
    </center>

</form>
<script>
    layui.use(['form', 'layer', 'upload', 'laydate'], function () {
        var form = layui.form;
        var layer = layui.layer;
        var upload = layui.upload;
        var $=layui.jquery;
        var laydate = layui.laydate;

        //常规用法
        laydate.render({
            elem: '#begintime'
        });
        laydate.render({
            elem: '#overtime'
        });

       $(function () {
           $.ajax({
               type:'get',
               url: '/customer/queryCustomer.do',
               datatype: 'json',
               success:function(data){
                   for (var i = 0; i < data.length; i++) {
                       $('#customername').append(new Option(data[i].customername, data[i].customerid))
                   }
                   form.render();
               }
           });
       })

        form.on('select(customername)', function(data){
            $.ajax({
                type:'get',
                url: '/customer/queryCustomerById.do?customerid='+data.value,
                datatype: 'json',
                success:function(cus){
                    $("#contactperson").val(cus.linkman);
                    $("#officephone").val(cus.officephone);
                    $("#telephone").val(cus.telephone);
                    $("#email").val(cus.email);
                    $.ajax({
                        type:'get',
                        url: '/contract/queryContractByCustomer.do?customerid='+data.value,
                        datatype: 'json',
                        success:function(contract){
                            for (var i = 0; i < contract.length; i++) {
                                $('#contractId').append(new Option(contract[i].contractname, contract[i].contractid))
                            }
                            form.render();
                        }
                    });
                }
            });
        })

        form.on('select(contractId)', function(data){
            $.ajax({
                type:'get',
                url: '/aftersale/queryContractSaleByContractId.do?contractid='+data.value,
                datatype: 'json',
                success:function(aftersale){
                   var str="【合同全称】:"+aftersale.contractname+"  【合同所属部门】:"+aftersale.deptname+"  【关联人员】:"
                       +aftersale.associatedpersons+"  【签约日期】:  "+aftersale.signingdate+"  【生效日期】："+aftersale.takedate
                       +"  【合同状态】："+aftersale.todaystate+"  【服务期至】："+aftersale.serviceto;
                    $("#info").val(str);

                }
            });
        })


    });
</script>
</body>
</html>